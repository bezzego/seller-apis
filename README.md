# Что делает скрипт seller.py

Этот скрипт помогает автоматически обновлять остатки товаров и цены в интернет-магазинах на площадке **Ozon**.

## Как это работает

Скрипт:
- Берет свежие данные о наличии и стоимости товаров с сайта поставщика 
- Загружает их в личные кабинеты магазинов
- Поддерживает информацию о товарах всегда актуальной

## Преимущества

- Экономит время
- Снижает риск ошибок при обновлении данных
- Все происходит автоматически:
  - Скачивание остатков
  - Проверка товаров 
  - Обновление цен
  - Обновление количества на складах

## Важно

Для работы скрипта нужны специальные доступы к кабинетам магазинов (токены), которые обычно выдает сама площадка. Без них скрипт не сможет подключиться к магазинам.

## Для кого это

Этот инструмент полезен тем, кто хочет поддерживать актуальность ассортимента и цен в интернет-магазинах без лишних хлопот и ручной работы.

# Описание функций в seller.py:

# price_conversion(price: str) -> str

Преобразует строку с ценой в числовой формат, удаляя все нечисловые символы.

## Аргументы
- `price` (str): Строка, содержащая цену в любом формате.
  - Например: `"5'990.00 руб."`, `"12 345 ₽"`, `"1,299.99"`

## Возвращает
- `str`: Строка, содержащая только цифры до десятичной точки.
  - Например: `"5990"`, `"12345"`, `"1299"`

## Примеры
```python
>>> price_conversion("5'990.00 руб.")
'5990'
>>> price_conversion("12 345 ₽") 
'12345'
```

## Исключения
- `TypeError`: Если передан неверный тип аргумента (не строка)

## Примечание
Функция игнорирует все, что находится после десятичной точки,
и удаляет все нечисловые символы (пробелы, валюту, разделители)

# get_product_list(last_id: str, client_id: str, seller_token: str) -> dict

Получает список товаров из магазина Ozon через API.

## Аргументы
- `last_id` (str): ID последнего полученного товара для пагинации
- `client_id` (str): ID клиента в системе Ozon
- `seller_token` (str): Токен для авторизации в API Ozon

## Возвращает
- `dict`: Словарь с информацией о товарах
  - Содержит: items (список товаров), total (общее количество), last_id

## Пример
```python
>>> get_product_list("", "12345", "ABCD-token")
{
    'items': [...],
    'total': 100,
    'last_id': "20"
}
```

## Исключения
- `requests.exceptions.HTTPError`: При ошибке API запроса

# get_offer_ids(client_id: str, seller_token: str) -> list

Получает список артикулов всех товаров из магазина Ozon.

## Аргументы
- `client_id` (str): ID клиента в системе Ozon
- `seller_token` (str): Токен для авторизации в API Ozon

## Возвращает
- `list`: Список артикулов товаров

## Пример
```python
>>> get_offer_ids("12345", "ABCD-token")
["A1234", "B5678", "C9012"]
```

# update_price(prices: list, client_id: str, seller_token: str) -> dict

Обновляет цены товаров в магазине Ozon.

## Аргументы
- `prices` (list): Список словарей с ценами товаров
- `client_id` (str): ID клиента в системе Ozon 
- `seller_token` (str): Токен для авторизации в API Ozon

## Возвращает
- `dict`: Ответ API об успешности обновления цен

## Пример
```python
>>> prices = [{"offer_id": "A1234", "price": "5990"}]
>>> update_price(prices, "12345", "ABCD-token")
{"result": "success"}
```

# update_stocks(stocks: list, client_id: str, seller_token: str) -> dict

Обновляет остатки товаров в магазине Ozon.

## Аргументы
- `stocks` (list): Список словарей с остатками товаров
- `client_id` (str): ID клиента в системе Ozon
- `seller_token` (str): Токен для авторизации в API Ozon

## Возвращает
- `dict`: Ответ API об успешности обновления остатков

## Пример
```python
>>> stocks = [{"offer_id": "A1234", "stock": 10}]
>>> update_stocks(stocks, "12345", "ABCD-token")
{"result": "success"}
```

# download_stock() -> list

Скачивает файл остатков с сайта поставщика и преобразует его в список товаров.

## Возвращает
- `list`: Список словарей с информацией о товарах

## Пример
```python
>>> download_stock()
[{"Код": "A1234", "Количество": "10", "Цена": "5990.00 руб."}]
```

## Исключения
- `requests.exceptions.HTTPError`: При ошибке скачивания файла

# create_stocks(watch_remnants: list, offer_ids: list) -> list

Создает список остатков товаров в формате для API Ozon.

## Аргументы
- `watch_remnants` (list): Список товаров от поставщика
- `offer_ids` (list): Список артикулов в магазине Ozon

## Возвращает
- `list`: Список словарей с остатками для API Ozon

## Пример
```python
>>> remnants = [{"Код": "A1234", "Количество": "10"}]
>>> create_stocks(remnants, ["A1234"])
[{"offer_id": "A1234", "stock": 10}]
```

# create_prices(watch_remnants: list, offer_ids: list) -> list

Создает список цен товаров в формате для API Ozon.

## Аргументы
- `watch_remnants` (list): Список товаров от поставщика
- `offer_ids` (list): Список артикулов в магазине Ozon

## Возвращает
- `list`: Список словарей с ценами для API Ozon

## Пример
```python
>>> remnants = [{"Код": "A1234", "Цена": "5990.00 руб."}]
>>> create_prices(remnants, ["A1234"])
[{
    "offer_id": "A1234",
    "price": "5990",
    "old_price": "0",
    "currency_code": "RUB"
}]
```

# divide(lst: list, n: int) -> list

Разделяет список на части заданного размера.

## Аргументы
- `lst` (list): Исходный список
- `n` (int): Размер каждой части

## Возвращает
- `generator`: Генератор списков заданного размера

## Пример
```python
>>> list(divide([1,2,3,4,5], 2))
[[1,2], [3,4], [5]]
```

---
---
---

# Что делает скрипт market.py

Этот скрипт выполняет те же задачи, что и seller.py, но для магазина на **Яндекс.Маркете**. Он поддерживает работу с двумя типами магазинов:

- FBS (Fulfilled by Seller) - когда товары хранятся на вашем складе
- DBS (Delivered by Seller) - когда вы сами доставляете товары покупателям

## Как это работает

Скрипт:
- Получает актуальные данные о товарах от поставщика
- Обновляет информацию в обоих типах магазинов:
  - Загружает новые цены
  - Обновляет остатки на складах
  - Синхронизирует наличие товаров

## Преимущества

- Поддерживает два типа магазинов одновременно
- Учитывает особенности работы с Яндекс.Маркетом
- Автоматизирует рутинные операции:
  - Обновление остатков
  - Изменение цен
  - Синхронизацию товаров

## Важно

Для работы нужны:
- Токен доступа к API Яндекс.Маркета
- ID кампаний для FBS и DBS магазинов
- ID складов для обоих типов магазинов

## Для кого это

Этот инструмент будет полезен продавцам на Яндекс.Маркете, особенно тем, кто работает одновременно в форматах FBS и DBS и хочет автоматизировать обновление данных о товарах.

# Описание функций в market.py:

# get_product_list(page: str, campaign_id: str, access_token: str) -> dict

Получает список товаров из магазина на Яндекс.Маркете через API.

## Аргументы
- `page` (str): Токен страницы для пагинации
- `campaign_id` (str): ID магазина на Яндекс.Маркете
- `access_token` (str): Токен для авторизации в API

## Возвращает
- `dict`: Словарь с информацией о товарах

## Пример
```python
>>> get_product_list("", "12345", "y0_AgAAAABR7C9...")
{
    'offerMappingEntries': [...],
    'paging': {'nextPageToken': 'page2'}
}
```

## Исключения
- `requests.exceptions.HTTPError`: При ошибке API запроса

# update_stocks(stocks: list, campaign_id: str, access_token: str) -> dict

Обновляет остатки товаров в магазине на Яндекс.Маркете.

## Аргументы
- `stocks` (list): Список словарей с остатками товаров
- `campaign_id` (str): ID магазина на Яндекс.Маркете
- `access_token` (str): Токен для авторизации в API

## Возвращает
- `dict`: Ответ API об успешности обновления остатков

## Пример
```python
>>> stocks = [{
    "sku": "A1234",
    "warehouseId": 1234,
    "items": [{"count": 10, "type": "FIT"}]
}]
>>> update_stocks(stocks, "12345", "y0_AgAAAABR7C9...")
{"status": "OK"}
```

# update_price(prices: list, campaign_id: str, access_token: str) -> dict

Обновляет цены товаров в магазине на Яндекс.Маркете.

## Аргументы
- `prices` (list): Список словарей с ценами товаров
- `campaign_id` (str): ID магазина на Яндекс.Маркете 
- `access_token` (str): Токен для авторизации в API

## Возвращает
- `dict`: Ответ API об успешности обновления цен

## Пример
```python
>>> prices = [{
    "id": "A1234",
    "price": {"value": 5990, "currencyId": "RUR"}
}]
>>> update_price(prices, "12345", "y0_AgAAAABR7C9...")
{"status": "OK"}
```

# create_stocks(watch_remnants: list, offer_ids: list, warehouse_id: str) -> list

Создает список остатков товаров в формате для API Яндекс.Маркета.

## Аргументы
- `watch_remnants` (list): Список товаров от поставщика
- `offer_ids` (list): Список артикулов в магазине
- `warehouse_id` (str): ID склада в Яндекс.Маркете

## Возвращает
- `list`: Список словарей с остатками для API

## Пример
```python
>>> remnants = [{"Код": "A1234", "Количество": "10"}]
>>> create_stocks(remnants, ["A1234"], "1234")
[{
    "sku": "A1234",
    "warehouseId": "1234",
    "items": [{"count": 10, "type": "FIT"}]
}]
```

# create_prices(watch_remnants: list, offer_ids: list) -> list

Создает список цен товаров в формате для API Яндекс.Маркета.

## Аргументы
- `watch_remnants` (list): Список товаров от поставщика
- `offer_ids` (list): Список артикулов в магазине

## Возвращает
- `list`: Список словарей с ценами для API

## Пример
```python
>>> remnants = [{"Код": "A1234", "Цена": "5990.00 руб."}]
>>> create_prices(remnants, ["A1234"])
[{
    "id": "A1234",
    "price": {"value": 5990, "currencyId": "RUR"}
}]
```

# async upload_prices(watch_remnants: list, campaign_id: str, market_token: str) -> list

Асинхронно загружает цены товаров в магазин на Яндекс.Маркете.

## Аргументы
- `watch_remnants` (list): Список товаров от поставщика
- `campaign_id` (str): ID магазина на Яндекс.Маркете
- `market_token` (str): Токен для авторизации в API

## Возвращает
- `list`: Список обновленных цен

## Пример
```python
>>> remnants = [{"Код": "A1234", "Цена": "5990.00 руб."}]
>>> await upload_prices(remnants, "12345", "y0_AgAAAABR7C9...")
[{
    "id": "A1234",
    "price": {"value": 5990, "currencyId": "RUR"}
}]
```

# async upload_stocks(watch_remnants: list, campaign_id: str, market_token: str, warehouse_id: str) -> tuple

Асинхронно загружает остатки товаров в магазин на Яндекс.Маркете.

## Аргументы
- `watch_remnants` (list): Список товаров от поставщика
- `campaign_id` (str): ID магазина на Яндекс.Маркете
- `market_token` (str): Токен для авторизации в API
- `warehouse_id` (str): ID склада

## Возвращает
- `tuple`: Кортеж из двух списков:
  - Список товаров с ненулевыми остатками
  - Полный список всех товаров с остатками

## Пример
```python
>>> remnants = [{"Код": "A1234", "Количество": "10"}]
>>> not_empty, all_stocks = await upload_stocks(
...     remnants, "12345", "y0_AgAAAABR7C9...", "1234"
... )
>>> not_empty
[{
    "sku": "A1234",
    "warehouseId": "1234",
    "items": [{"count": 10, "type": "FIT"}]
}]
```